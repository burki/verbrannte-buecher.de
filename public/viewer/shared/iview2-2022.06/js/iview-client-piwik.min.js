var mycore,__extends=this&&this.__extends||function(){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){var t,n,i;t=e.viewer||(e.viewer={}),n=t.components||(t.components={}),i=function(i){function e(e){var t=i.call(this)||this;return t._settings=e,t.initialized=!1,t}return __extends(e,i),e.prototype.handle=function(e){if(1==this.initialized&&e.type==n.events.ImageChangedEvent.TYPE){var t=e;this.trackImage(t.image.href)}else if(e.type==n.events.ComponentInitializedEvent.TYPE){var i=e;ClassDescriber.ofEqualClass(i.component,this)&&(this.trackImage(this._settings.filePath),this.initialized=!0)}},Object.defineProperty(e.prototype,"handlesEvents",{get:function(){var e=new Array;return e.push(n.events.ImageChangedEvent.TYPE),e.push(n.events.ComponentInitializedEvent.TYPE),e},enumerable:!0,configurable:!0}),e.prototype.trackImage=function(e){if("undefined"!=typeof Piwik){var t=this._settings.derivate,i=this._settings.webApplicationBaseURL+"/servlets/MCRIviewClient?derivate="+t+"&page="+e;Piwik.getAsyncTracker().trackLink(i,"download")}else console.log("warn: unable to track image "+e+" cause Piwik js object is undefined")},e.prototype.init=function(){window._paq=[];var e=this._settings["MCR.Piwik.baseurl"];null==e&&console.log("Error: unable to get piwik base url (MCR.Piwik.baseurl)");var t=this._settings["MCR.Piwik.id"];null==t&&console.log("Error: unable to get piwik id (MCR.Piwik.id)"),window._paq.push(["setTrackerUrl",e+"piwik.php"]),window._paq.push(["setSiteId",t]);var i=this;jQuery.getScript(e+"piwik.js",function(){i.trigger(new n.events.ComponentInitializedEvent(i))})},e}(n.ViewerComponent),n.MyCoRePiwikComponent=i}(mycore||(mycore={})),addViewerComponent(mycore.viewer.components.MyCoRePiwikComponent),console.log("PIWIK MODULE");